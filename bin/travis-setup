#!/bin/bash
# Script, which is run before travis build.
# Installs some dependency, depending on on which OS travis is running.

# shellcheck source=./travis-share.sh
_dir="$( dirname "$0" )"
source "${_dir}/travis-share.sh"
unset _dir

function run_install {
case "$TRAVIS_OS_NAME" in
  "linux")
    sudo apt-get update
    sudo apt-get install -y \
    curl \
    tee \
    pcregrep \
    libsdl2-dev

    # Kind of ironic, that ubuntu is the only one of these OSes,
    # that doesn't have `gdrive` available in their main repos.
    local GDRIVE_DOWNLOAD="https://github.com/gdrive-org/gdrive/releases/download/2.1.0/gdrive-linux-x64"
    curl -L "$GDRIVE_DOWNLOAD" | sudo tee /bin/gdrive 1> /dev/null
    ;;

  "windows")
    choco install \
      grep \
      gdrive
    ;;

  "osx")
    check "brew"
    brew update
    brew install SDL2 gdrive
    ;;

  *)
    err "Unrecognized OS $( colored "$COLOR_CODE" "$TRAVIS_OS_NAME" )"
    ;;
esac
}

      run_install
